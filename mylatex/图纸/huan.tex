		\ifx \allfiles \undefined		%编译PPT时注释该行
\documentclass{ctexart}
\input{structure.tex}
\lhead{热工专业图纸}
\rhead{净烟气CEMS信号传递示意图}
\cfoot{热工专业图纸~第~\thepage~页 （共 \pageref{LastPage} 页）}
\begin{document}
		\else						%编译PPT时注释该行
			\chapter{净烟气CEMS信号传递示意图}	%编译PPT时注释该行
		\newpage
		\fi						%编译PPT时注释该行
\begin{center}
{\huge 净烟气CEMS信号传递示意图}\\
\end{center}
\begin{center}

\begin{figure}[!htp]
\begin{tikzpicture}[scale=1]

\node[circle,fill=blue,text=white,minimum width=35pt] (A) at (0,0) {$SO_2$};
\node[circle,fill=blue,text=white,minimum width=35pt] (A) at (2,0) {$NO_x$};
\node[circle,fill=blue,text=white,minimum width=35pt] (A) at (4,0) {$O_2$};
\node[circle,fill=blue,text=white,minimum width=35pt] (A) at (6,0) {粉尘};

\node[circle,fill=blue,text=white,minimum width=35pt] (A) at (9,0) {流速};
\node[circle,fill=blue,text=white,minimum width=35pt] (A) at (11,0) {压力};
\node[circle,fill=blue,text=white,minimum width=35pt] (A) at (13,0) {温度};
\node[circle,fill=blue,text=white,minimum width=35pt] (A) at (15,0) {湿度};

\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](43i) at (0,-2) {43i};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](D5) at (0,-8) {端口5};
\draw[-latex,green] (43i) -- node[left]{R232} (D5);

\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](42i) at (2,-2) {42i};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](D4) at (2,-8) {端口4};
\draw[-latex,green] (42i) -- node[left]{R232} (D4);

\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](O1) at (4,-2) {氧化锆};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](O2) at (4,-4) {TXO-1000};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](D3) at (4,-8) {端口3};
\draw[-latex] (O1) -- node[left]{mV} (O2);
\draw[-latex,green] (O2) -- node[left]{R232} (D3);

\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](80i) at (6,-2) {3880i};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](R4) at (6,-4) {R485/232};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](D7) at (6,-8) {端口7};
\draw[-latex,green] (80i) -- node[left]{R232} (R4);
\draw[-latex,green] (R4) -- node[left]{R485} (D7);
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](X1) at (7.5,-6) {信号隔离器};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](ABB) at (13,-6) {ABB PLC（温、压、流、湿）};
\draw[-latex] (X1) -- node[above]{4-20mA} (ABB);
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](D6) at (13,-8) {端口6};
\draw[-latex,green] (ABB) -- node[left]{R232} (D6);
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=480pt](DGY) at (7.5,-8) {动管仪};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=200pt](DCS) at (4,-10) {DCS};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=200pt](HBJ) at (12,-10) {环保局};
\draw[-latex] (DGY) -- node[above left]{4-20mA} (DCS);
\draw[-latex,green] (DGY) -- node[above right]{无线（DTU）} (HBJ);

\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](P) at (9,2) {皮托管};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=100pt](WYL) at (11,4) {温压流一体机};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](X) at (9,6) {信号隔离器};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=20pt](AI1) at (9,8) {AI1};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=480pt](S7) at (7.5,8) {S7 200PLC};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=480pt](SWJ) at (7.5,10) {上位机（环保数据画面、曲线、报表）};
\draw[-latex] (P) -- node[left]{P} (WYL);.
\draw[-latex] (WYL) -- node[left]{4-20mA} (X);
\draw[-latex] (X) -- node[left]{4-20mA} (AI1);
\draw[-latex] (X) -- node[left]{4-20mA} (80i);
\draw[-latex,red] (S7) -- node[right]{4-20mA} (X1);
\draw[-latex,green] (S7) -- node[right]{PPI} (SWJ);

\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](Y) at (11,2) {压力模块};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=20pt](AI2) at (11,8) {AI2};
\draw[-latex] (Y) -- node[left]{P}(WYL);
\draw[-latex] (WYL) -- node[left]{..} (AI2);

\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](W) at (13,2) {PT100};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=20pt](AI3) at (13,8) {AI3};
\draw[-latex] (W) -- node[right]{Ω} (WYL);
\draw[-latex] (WYL) -- node[right]{4-20mA} (AI3);



\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](DMT143) at (15,2) {DMT143};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=35pt](TH-200) at (15,4) {TH-200};
\node[rectangle,rounded corners,draw=gray,node font={\sffamily\slshape},minimum width=20pt](AI4) at (15,8) {AI4};
\draw[-latex,green] (DMT143) -- node[left]{R232} (TH-200);
\draw[-latex] (TH-200) -- node[left]{4-20mA} (AI4);
\end{tikzpicture}
\caption{CEMS动管仪改造后信号指示图}
\end{figure}
\end{center}
		\ifx \allfiles \undefined
\end{document}
\fi
